<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Device Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        
        .device-container {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .device-display {
            width: 600px;
            height: 100px;
            border: 2px solid #ddd;
            margin: 10px 0;
            background: white;
        }
        
        button {
            margin: 5px;
            padding: 8px 16px;
            background: #007cba;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .info {
            background: #fff3cd;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <h1>Simple Device Image Test</h1>
    
    <div class="info">
        <strong>CORS Issue:</strong> Modern browsers block file:// access to JSON files. 
        <br><strong>Solutions:</strong>
        <ol>
            <li><strong>Serve via web server</strong> (recommended)</li>
            <li><strong>Test images directly</strong> using this simple test</li>
        </ol>
    </div>

    <div class="device-container">
        <h3>Test: Direct Image Loading</h3>
        <p>This tests if the Cisco switch images load correctly when saved to the switches folder.</p>
        
        <div class="controls">
            <button onclick="testImage('cisco-c9200l-24t-4g.png', 'img1')">Test 24-Port Image</button>
            <button onclick="testImage('cisco-c9200l-48p-4g.png', 'img2')">Test 48-Port Image</button>
            <button onclick="clearAll()">Clear All</button>
        </div>
        
        <div style="display: flex; gap: 20px;">
            <div>
                <h4>24-Port Switch:</h4>
                <div id="img1" class="device-display"></div>
            </div>
            <div>
                <h4>48-Port Switch:</h4>
                <div id="img2" class="device-display"></div>
            </div>
        </div>
    </div>

    <div class="device-container">
        <h3>Test: Canvas Fallback</h3>
        <p>This tests our canvas-rendered switches directly.</p>
        
        <div class="controls">
            <button onclick="testCanvas('canvas1', 24)">Render 24-Port Canvas</button>
            <button onclick="testCanvas('canvas2', 48)">Render 48-Port Canvas</button>
        </div>
        
        <div style="display: flex; gap: 20px;">
            <div>
                <h4>24-Port Canvas:</h4>
                <canvas id="canvas1" class="device-display" width="600" height="100"></canvas>
            </div>
            <div>
                <h4>48-Port Canvas:</h4>
                <canvas id="canvas2" class="device-display" width="600" height="100"></canvas>
            </div>
        </div>
    </div>

    <script>
        function testImage(filename, targetId) {
            const target = document.getElementById(targetId);
            target.innerHTML = '';
            
            const img = new Image();
            img.onload = function() {
                target.innerHTML = '';
                img.style.cssText = `
                    max-width: 100%;
                    max-height: 100%;
                    object-fit: contain;
                `;
                target.appendChild(img);
                console.log(`✅ Successfully loaded: ${filename}`);
            };
            
            img.onerror = function() {
                target.innerHTML = '<div style="padding: 20px; color: red; text-align: center;">❌ Image not found:<br>' + filename + '</div>';
                console.log(`❌ Failed to load: ${filename}`);
            };
            
            img.src = './switches/' + filename;
        }
        
        function testCanvas(canvasId, portCount) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            ctx.imageSmoothingEnabled = false;
            
            // Clear canvas
            ctx.fillStyle = '#fafbfc';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Simple switch representation
            const switchHeight = 60;
            const switchWidth = 500;
            const startX = (canvas.width - switchWidth) / 2;
            const startY = (canvas.height - switchHeight) / 2;
            
            // Draw switch body
            ctx.fillStyle = '#d0d0d0';
            ctx.fillRect(startX, startY, switchWidth, switchHeight);
            ctx.strokeStyle = '#1a1a1a';
            ctx.lineWidth = 2;
            ctx.strokeRect(startX, startY, switchWidth, switchHeight);
            
            // Draw ports
            const portCount24 = portCount === 24 ? 24 : 48;
            const rows = portCount === 24 ? 1 : 2;
            const portsPerRow = portCount === 24 ? 24 : 24;
            
            for (let row = 0; row < rows; row++) {
                for (let port = 0; port < portsPerRow; port++) {
                    const portX = startX + 20 + (port * 18);
                    const portY = startY + 15 + (row * 25);
                    
                    // Port
                    ctx.fillStyle = '#000000';
                    ctx.fillRect(portX, portY, 15, 10);
                    ctx.fillStyle = '#ffffff';
                    ctx.fillRect(portX + 1, portY + 1, 13, 8);
                    
                    // LEDs
                    ctx.fillStyle = '#00ff00';
                    ctx.fillRect(portX + 2, portY + 2, 2, 2);
                    ctx.fillStyle = '#ffaa00';
                    ctx.fillRect(portX + 11, portY + 2, 2, 2);
                }
            }
            
            // Label
            ctx.fillStyle = '#333333';
            ctx.font = '12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText(`${portCount}-Port Switch (Canvas Fallback)`, canvas.width / 2, startY + switchHeight + 20);
            
            console.log(`✅ Rendered ${portCount}-port canvas switch`);
        }
        
        function clearAll() {
            document.getElementById('img1').innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">Cleared</div>';
            document.getElementById('img2').innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">Cleared</div>';
            
            const canvas1 = document.getElementById('canvas1');
            const canvas2 = document.getElementById('canvas2');
            const ctx1 = canvas1.getContext('2d');
            const ctx2 = canvas2.getContext('2d');
            
            ctx1.clearRect(0, 0, canvas1.width, canvas1.height);
            ctx2.clearRect(0, 0, canvas2.width, canvas2.height);
        }
    </script>
</body>
</html>